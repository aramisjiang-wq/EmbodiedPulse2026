# 招聘信息抓取方案设计

**文档创建时间**: 2025-12-09  
**最后更新时间**: 2025-12-09  
**数据源**: https://github.com/StarCycle/Awesome-Embodied-AI-Job

---

## 📋 需求分析

### 功能需求
1. **数据来源**：GitHub仓库的"Rolling Recruitment | 滚动招聘"模块
2. **数据内容**：更新日期、文字描述、链接
3. **更新频率**：每天定期抓取
4. **展示方式**：右侧小挂窗，滚动显示，一次展示20个
5. **数据存储**：独立数据库（jobs.db）

---

## 🎯 技术方案

### 方案1: GitHub API（推荐）

**优点**：
- ✅ 官方API，稳定可靠
- ✅ 无需解析HTML
- ✅ 支持Markdown格式
- ✅ 有速率限制但足够使用

**实现步骤**：
1. 使用GitHub API获取README.md内容
2. 解析Markdown，提取"Rolling Recruitment"部分
3. 使用正则表达式提取日期、文字、链接
4. 保存到数据库

**API端点**：
```
GET https://api.github.com/repos/StarCycle/Awesome-Embodied-AI-Job/readme
```

### 方案2: 直接爬取GitHub页面

**优点**：
- ✅ 无需API Token（公开仓库）
- ✅ 直接获取渲染后的内容

**缺点**：
- ❌ 需要解析HTML
- ❌ 可能受GitHub页面结构变化影响

### 方案3: 克隆仓库（不推荐）

**缺点**：
- ❌ 需要Git操作
- ❌ 资源消耗大
- ❌ 维护复杂

---

## 🗄️ 数据库设计

### 表结构：`jobs`

```sql
CREATE TABLE jobs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,              -- 招聘标题
    description TEXT,                  -- 描述信息
    link TEXT,                         -- 链接URL
    update_date TEXT,                  -- 更新日期（从GitHub提取）
    source_date TEXT,                  -- 数据源中的日期（如2025.3.10）
    company TEXT,                      -- 公司/机构名称
    location TEXT,                     -- 地点
    job_type TEXT,                     -- 职位类型（PhD/PostDoc/Intern/FullTime等）
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(link, source_date)          -- 基于链接和日期去重
);
```

### 索引
- `idx_update_date`: 按更新日期排序
- `idx_link`: 快速查找重复链接
- `idx_created_at`: 按创建时间排序

---

## 🔧 实现架构

### 1. 数据抓取模块

**文件**: `github_jobs_client.py`

**功能**：
- 使用GitHub API获取README内容
- 解析Markdown，提取"Rolling Recruitment"部分
- 使用正则表达式提取招聘信息
- 返回结构化数据

**关键函数**：
```python
def fetch_jobs_from_github():
    """从GitHub获取招聘信息"""
    pass

def parse_rolling_recruitment(markdown_content):
    """解析滚动招聘部分"""
    pass

def extract_job_info(text):
    """提取单个招聘信息（日期、文字、链接）"""
    pass
```

### 2. 数据存储模块

**文件**: `jobs_models.py`

**功能**：
- 定义Job模型
- 数据库初始化
- 去重逻辑

**文件**: `save_jobs_to_db.py`

**功能**：
- 保存招聘信息到数据库
- 基于链接和日期去重
- 更新已存在的记录

### 3. 定时任务

**集成到**: `app.py`

**功能**：
- 每天执行一次抓取
- 使用APScheduler
- 错误处理和日志记录

### 4. API接口

**路由**: `/api/jobs`

**功能**：
- 返回最新的20条招聘信息
- 支持分页
- 按更新日期倒序

### 5. 前端展示

**位置**: 右侧固定挂窗

**样式**：
- 固定定位（position: fixed）
- 右侧悬浮
- 可滚动容器
- 卡片式布局

**交互**：
- 自动滚动或手动滚动
- 点击跳转到链接
- 显示更新日期

---

## 📊 数据解析策略

### Markdown结构分析

根据GitHub仓库，招聘信息格式可能为：
```
**[日期] 公司/机构 - 职位描述 - 职位类型**

或

**[日期] 公司/机构 - 职位描述**
```

### 正则表达式模式

```python
# 匹配日期格式：2025.3.10, 2025.2.28等
date_pattern = r'\[(\d{4}\.\d{1,2}\.\d{1,2})\]'

# 匹配链接：[文本](URL)
link_pattern = r'\[([^\]]+)\]\(([^\)]+)\)'

# 匹配完整招聘条目
job_pattern = r'\*\*\[(\d{4}\.\d{1,2}\.\d{1,2})\]\s+([^\*]+)\*\*'
```

### 解析流程

1. 找到"Rolling Recruitment | 滚动招聘"部分
2. 提取该部分的所有内容
3. 按行分割
4. 使用正则表达式匹配每个招聘条目
5. 提取日期、公司、职位、链接等信息

---

## ⏰ 定时任务配置

### Cron表达式
```
0 3 * * *  # 每天凌晨3点执行
```

### 执行流程
1. 调用GitHub API获取README
2. 解析Markdown内容
3. 提取招聘信息
4. 保存到数据库（去重）
5. 记录日志

---

## 🎨 前端设计

### 布局位置
- **位置**：右侧固定挂窗
- **宽度**：300-350px
- **高度**：视口高度的60-80%
- **定位**：`position: fixed; right: 20px; top: 20%`

### 样式设计
- 半透明背景（毛玻璃效果）
- 圆角边框
- 阴影效果
- 滚动条美化

### 交互功能
- 自动滚动（可选）
- 鼠标悬停暂停滚动
- 点击卡片跳转链接
- 显示更新日期

---

## 🔍 去重策略

### 去重依据
1. **链接 + 日期**：同一链接但不同日期视为不同记录
2. **标题 + 日期**：如果没有链接，使用标题+日期

### 更新逻辑
- 如果链接和日期都相同，更新现有记录
- 如果只有链接相同但日期不同，创建新记录
- 如果完全不存在，创建新记录

---

## ⚠️ 注意事项

1. **GitHub API限制**
   - 未认证：60次/小时
   - 认证后：5000次/小时
   - 建议：使用认证Token（可选）

2. **Markdown解析**
   - GitHub的README可能包含复杂格式
   - 需要处理各种Markdown语法
   - 考虑使用专门的Markdown解析库

3. **数据更新**
   - GitHub仓库可能不定期更新
   - 需要处理格式变化
   - 建议添加错误处理

4. **性能优化**
   - 只抓取"Rolling Recruitment"部分
   - 避免解析整个README
   - 使用缓存机制（可选）

---

## 📝 实施步骤

1. **创建数据库模型** (`jobs_models.py`)
2. **实现GitHub客户端** (`github_jobs_client.py`)
3. **实现数据保存** (`save_jobs_to_db.py`)
4. **创建抓取脚本** (`fetch_jobs.py`)
5. **添加API接口** (`app.py`)
6. **实现前端展示** (`templates/index.html`, `static/js/app.js`, `static/css/style.css`)
7. **配置定时任务** (`app.py`)
8. **测试和优化**

---

## 🔄 数据流程

```
GitHub仓库
    ↓
GitHub API / 爬取
    ↓
Markdown解析
    ↓
数据提取（日期、文字、链接）
    ↓
去重检查
    ↓
保存到jobs.db
    ↓
API接口 (/api/jobs)
    ↓
前端展示（右侧挂窗）
```

---

## 📚 参考资源

- [GitHub API文档](https://docs.github.com/en/rest)
- [Awesome-Embodied-AI-Job仓库](https://github.com/StarCycle/Awesome-Embodied-AI-Job)
- [Markdown解析库](https://github.com/Python-Markdown/markdown)

---

**操作时间**: 2025-12-09  
**操作人员**: AI Assistant

