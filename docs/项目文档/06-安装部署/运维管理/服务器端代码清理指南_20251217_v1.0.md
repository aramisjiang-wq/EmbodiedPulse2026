# 服务器端代码清理指南

**版本**: v1.0  
**日期**: 2025-12-17  
**目的**: 清理服务器上不再需要的文件，释放磁盘空间

---

## 📋 清理内容

### 1. 日志文件清理
- 应用日志（保留最近7天）
- systemd日志（保留最近7天）

### 2. 备份文件清理
- 旧数据库备份（保留最近7天）

### 3. 缓存文件清理
- Python缓存（`__pycache__`, `*.pyc`）
- 临时文件（`*.tmp`, `*.swp`）

---

## 🚀 使用方法

### 方法1：使用清理脚本（推荐）

```bash
# SSH登录服务器
ssh root@101.200.222.139

# 进入项目目录
cd /srv/EmbodiedPulse2026

# 拉取最新代码（包含清理脚本）
git pull origin main

# 执行清理脚本
chmod +x scripts/cleanup_server_files.sh
bash scripts/cleanup_server_files.sh
```

### 方法2：手动清理

```bash
# 1. 清理旧日志（保留7天）
find /srv/EmbodiedPulse2026/logs -name "*.log" -mtime +7 -delete

# 2. 清理systemd日志（保留7天）
journalctl --vacuum-time=7d

# 3. 清理旧备份（保留7天）
find /srv/EmbodiedPulse2026/backups -name "*.db.gz" -mtime +7 -delete

# 4. 清理Python缓存
find /srv/EmbodiedPulse2026 -type d -name "__pycache__" -exec rm -rf {} +
find /srv/EmbodiedPulse2026 -name "*.pyc" -delete

# 5. 清理临时文件
find /srv/EmbodiedPulse2026 -name "*.tmp" -delete
find /srv/EmbodiedPulse2026 -name "*.swp" -delete
```

---

## 📊 清理效果

**清理前**:
- 日志文件可能占用大量空间
- 旧备份文件累积
- Python缓存文件

**清理后**:
- 释放磁盘空间
- 保留最近7天的日志和备份
- 清理缓存和临时文件

---

## ⚠️ 注意事项

1. **备份优先**: 清理脚本会将文件移动到备份目录，不直接删除
2. **保留期限**: 默认保留7天，可根据需要调整
3. **定期清理**: 建议每月执行一次清理

---

**文档版本**: v1.0  
**最后更新**: 2025-12-17  
**维护者**: AI Assistant

