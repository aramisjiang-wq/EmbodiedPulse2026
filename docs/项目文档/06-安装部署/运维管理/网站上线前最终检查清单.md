# 网站上线前最终检查清单

## 📋 检查清单

请逐项检查，确保所有项目都已完成并测试通过。

---

## 一、服务器基础配置 ✅

### 1.1 系统环境
- [ ] 服务器已安装 Python 3.9+
- [ ] 服务器已安装 Nginx
- [ ] 服务器已安装 Git
- [ ] 防火墙端口已开放（80, 443, 22）

**验证命令：**
```bash
python3 --version
nginx -v
git --version
```

### 1.2 代码部署
- [ ] 代码已克隆到 `/srv/EmbodiedPulse2026`
- [ ] 虚拟环境已创建并激活
- [ ] Python 依赖已安装（`pip install -r requirements.txt`）
- [ ] `.env` 配置文件已创建并配置

**验证命令：**
```bash
cd /srv/EmbodiedPulse2026
ls -la
source venv/bin/activate
pip list | grep -i flask
cat .env | grep AUTO_FETCH
```

---

## 二、服务配置 ✅

### 2.1 Systemd 服务
- [ ] `embodiedpulse` 服务已创建
- [ ] 服务已启动并运行正常
- [ ] 服务已设置为开机自启

**验证命令：**
```bash
systemctl status embodiedpulse
systemctl is-enabled embodiedpulse
journalctl -u embodiedpulse -n 20
```

### 2.2 Nginx 配置
- [ ] Nginx 配置文件已创建：`/etc/nginx/sites-available/embodiedpulse.conf`
- [ ] 配置文件语法正确
- [ ] Nginx 服务运行正常
- [ ] 所有域名路由配置正确

**验证命令：**
```bash
nginx -t
systemctl status nginx
grep -A 5 "server_name" /etc/nginx/sites-available/embodiedpulse.conf
```

---

## 三、域名和 DNS ✅

### 3.1 DNS 解析
- [ ] `login.gradmotion.com` → `101.200.222.139`
- [ ] `essay.gradmotion.com` → `101.200.222.139`
- [ ] `blibli.gradmotion.com` → `101.200.222.139`
- [ ] `admin123.gradmotion.com` → `101.200.222.139`

**验证命令：**
```bash
dig login.gradmotion.com +short
dig essay.gradmotion.com +short
dig blibli.gradmotion.com +short
dig admin123.gradmotion.com +short
```

### 3.2 HTTPS 证书
- [ ] 所有域名已申请 SSL 证书
- [ ] HTTP 自动跳转到 HTTPS
- [ ] 证书自动续期已配置

**验证命令：**
```bash
certbot certificates
curl -I http://essay.gradmotion.com  # 应该返回 301 跳转到 HTTPS
```

---

## 四、数据库 ✅

### 4.1 数据库文件
- [ ] `instance/papers.db` 存在且有数据
- [ ] `bilibili.db` 存在且有数据
- [ ] 数据库文件权限正确（644）

**验证命令：**
```bash
ls -lh /srv/EmbodiedPulse2026/instance/papers.db
ls -lh /srv/EmbodiedPulse2026/bilibili.db
du -h /srv/EmbodiedPulse2026/instance/papers.db
```

### 4.2 数据库内容
- [ ] 论文数据可以正常查询
- [ ] B站视频数据可以正常查询
- [ ] 数据数量符合预期

**验证方法：**
- 访问 `http://essay.gradmotion.com`，查看论文列表
- 访问 `http://blibli.gradmotion.com`，查看视频数据

---

## 五、功能测试 ✅

### 5.1 登录功能
- [ ] `http://login.gradmotion.com` 可以访问
- [ ] 页面样式正常显示
- [ ] 飞书扫码登录功能正常
- [ ] 登录后跳转正常

**测试步骤：**
1. 访问登录页面
2. 点击"飞书扫码登录"
3. 完成登录流程
4. 验证跳转是否正常

### 5.2 具身论文页面
- [ ] `http://essay.gradmotion.com` 可以访问
- [ ] 未登录时自动跳转到登录页
- [ ] 登录后显示论文列表
- [ ] 论文分类和筛选功能正常
- [ ] "刷新论文数据"按钮功能正常
- [ ] 论文详情页面正常

**测试步骤：**
1. 未登录访问，验证跳转
2. 登录后访问，查看论文列表
3. 测试分类筛选
4. 点击"刷新论文数据"，验证功能
5. 点击论文标题，查看详情

### 5.3 具身视频页面
- [ ] `http://blibli.gradmotion.com` 可以访问
- [ ] 视频数据正常加载
- [ ] 图表正常显示（趋势图、热力图）
- [ ] 公司列表正常显示
- [ ] "刷新数据"按钮功能正常
- [ ] 页面响应式布局正常

**测试步骤：**
1. 访问视频页面
2. 检查数据是否加载
3. 切换图表视图（堆叠面积图/热力图）
4. 点击"刷新数据"
5. 调整浏览器窗口大小，检查响应式

### 5.4 管理端
- [ ] `http://admin123.gradmotion.com` 可以访问
- [ ] 管理员登录功能正常
- [ ] 用户管理功能正常
- [ ] 论文管理功能正常
- [ ] 视频管理功能正常

**测试步骤：**
1. 访问管理端
2. 使用管理员账号登录
3. 测试各个管理功能

---

## 六、定时任务 ✅

### 6.1 定时任务配置
- [ ] `.env` 中 `AUTO_FETCH_ENABLED=true`
- [ ] 定时任务调度器已启动
- [ ] 日志中有定时任务执行记录

**验证命令：**
```bash
cat /srv/EmbodiedPulse2026/.env | grep AUTO_FETCH
journalctl -u embodiedpulse | grep -i "定时任务\|scheduler"
```

### 6.2 数据自动更新
- [ ] 论文数据自动抓取正常
- [ ] B站数据自动抓取正常
- [ ] 数据更新频率符合预期

**验证方法：**
- 查看日志中的定时任务执行记录
- 等待一个抓取周期，检查数据是否更新

---

## 七、性能和安全 ✅

### 7.1 性能检查
- [ ] 页面加载速度正常（< 3秒）
- [ ] API 响应速度正常（< 1秒）
- [ ] 服务器资源使用正常（CPU < 80%, 内存充足）

**验证命令：**
```bash
top -p $(pgrep -f gunicorn)
free -h
df -h
```

### 7.2 安全检查
- [ ] HTTPS 已启用
- [ ] 敏感信息不在代码中（使用环境变量）
- [ ] SSH 密钥安全存储
- [ ] 数据库文件权限正确

---

## 八、监控和日志 ✅

### 8.1 日志配置
- [ ] 应用日志正常输出
- [ ] Nginx 日志正常记录
- [ ] 错误日志可以查看

**验证命令：**
```bash
journalctl -u embodiedpulse -f
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

### 8.2 监控设置
- [ ] 服务状态监控（可选）
- [ ] 数据备份已配置（可选）

---

## 九、自动部署 ✅

### 9.1 GitHub Actions
- [ ] GitHub Secrets 已配置
- [ ] 自动部署工作流正常
- [ ] 测试推送后自动部署成功

**验证方法：**
1. 在 GitHub 仓库的 `Settings` → `Secrets` 检查
2. 推送一个测试提交
3. 在 `Actions` 页面查看部署日志

---

## 十、文档和备份 ✅

### 10.1 文档
- [ ] 部署文档完整
- [ ] 运维文档完整
- [ ] 故障排查文档完整

### 10.2 备份
- [ ] 数据库备份脚本已创建
- [ ] 自动备份已配置（可选）
- [ ] 备份文件存储位置明确

---

## 🎯 最终验证

### 完整功能测试

**在浏览器中依次访问并测试：**

1. **登录页面**
   ```
   http://login.gradmotion.com
   ```
   - [ ] 页面正常显示
   - [ ] 样式完整
   - [ ] 登录功能正常

2. **论文页面**
   ```
   http://essay.gradmotion.com
   ```
   - [ ] 自动跳转登录（如未登录）
   - [ ] 登录后显示论文
   - [ ] 所有功能正常

3. **视频页面**
   ```
   http://blibli.gradmotion.com
   ```
   - [ ] 数据正常加载
   - [ ] 图表正常显示
   - [ ] 所有功能正常

4. **管理端**
   ```
   http://admin123.gradmotion.com
   ```
   - [ ] 可以访问
   - [ ] 管理功能正常

### 自动化验证脚本

```bash
# 在服务器上执行
cd /srv/EmbodiedPulse2026
bash scripts/verify_deployment.sh
```

---

## ✅ 上线准备完成标志

当以下所有条件都满足时，网站可以正式上线：

- [x] 所有域名可以正常访问
- [x] 所有功能测试通过
- [x] HTTPS 证书已配置
- [x] 数据库数据完整
- [x] 定时任务正常运行
- [x] 自动部署配置完成
- [x] 备份策略已实施

---

## 🚀 上线后监控

上线后 24 小时内，重点关注：

1. **服务稳定性**
   - 每小时检查一次服务状态
   - 查看错误日志

2. **数据更新**
   - 验证定时任务是否正常执行
   - 检查数据是否及时更新

3. **用户反馈**
   - 收集用户反馈
   - 及时处理问题

---

## 📞 紧急联系方式

如果上线后出现问题：

1. **立即检查服务状态**
   ```bash
   systemctl status embodiedpulse
   systemctl status nginx
   ```

2. **查看错误日志**
   ```bash
   journalctl -u embodiedpulse -n 50
   tail -50 /var/log/nginx/error.log
   ```

3. **快速恢复**
   ```bash
   systemctl restart embodiedpulse
   systemctl restart nginx
   ```

---

## 🎉 恭喜！

当所有检查项都完成并测试通过后，你的网站就可以正式上线了！

**最后一步：** 在浏览器中访问你的域名，确认一切正常！

