# æœ¬åœ°åˆ°æœåŠ¡å™¨é…ç½®å˜æ›´å¯è§†åŒ–æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-19  
**æœ€åæ›´æ–°**: 2025-12-19  
**ç›®æ ‡è¯»è€…**: é›¶åŸºç¡€å°ç™½ï¼Œå¿«é€Ÿç†è§£é…ç½®å˜æ›´é€»è¾‘

---

## ğŸ¯ æ ¸å¿ƒé—®é¢˜ï¼šä»€ä¹ˆéœ€è¦æ”¹ï¼Ÿ

### ä¸€å¥è¯æ€»ç»“

**ä»£ç ä¸éœ€è¦æ”¹ï¼Œé…ç½®å¿…é¡»æ”¹ï¼**

- âœ… **ä»£ç **ï¼šè·¯ç”±ã€APIè°ƒç”¨ã€é™æ€æ–‡ä»¶å¼•ç”¨ â†’ **ä¸éœ€è¦æ”¹**
- âš ï¸ **é…ç½®**ï¼šç¯å¢ƒå˜é‡ã€æ•°æ®åº“ã€åŸŸåã€OAuth â†’ **å¿…é¡»æ”¹**

---

## ğŸ“Š æ•´ä½“æµç¨‹å›¾

### 1. éƒ¨ç½²æµç¨‹æ¦‚è§ˆ

```mermaid
graph TD
    A[æœ¬åœ°ä»£ç ] --> B{æ£€æŸ¥ä»£ç }
    B -->|è·¯ç”±/API/é™æ€æ–‡ä»¶| C[âœ… ä¸éœ€è¦æ”¹]
    B -->|ç¯å¢ƒå˜é‡/æ•°æ®åº“/åŸŸå| D[âš ï¸ å¿…é¡»æ”¹]
    
    C --> E[ç›´æ¥éƒ¨ç½²]
    D --> F[ä¿®æ”¹é…ç½®]
    
    F --> G[ä¿®æ”¹.envæ–‡ä»¶]
    F --> H[é…ç½®Nginx]
    F --> I[é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡]
    
    G --> J[éƒ¨ç½²åˆ°æœåŠ¡å™¨]
    H --> J
    I --> J
    
    J --> K[æµ‹è¯•éªŒè¯]
    K --> L[âœ… éƒ¨ç½²å®Œæˆ]
    
    style C fill:#90EE90
    style D fill:#FFB6C1
    style L fill:#90EE90
```

### 2. é…ç½®å˜æ›´å†³ç­–æ ‘

```mermaid
graph TD
    A[å¼€å§‹éƒ¨ç½²] --> B{è¿™æ˜¯ä»£ç è¿˜æ˜¯é…ç½®?}
    
    B -->|ä»£ç | C[è·¯ç”±å®šä¹‰<br/>@app.route]
    B -->|ä»£ç | D[å‰ç«¯APIè°ƒç”¨<br/>fetch/]
    B -->|ä»£ç | E[é™æ€æ–‡ä»¶å¼•ç”¨<br/>url_for]
    
    C --> F[âœ… ä¸éœ€è¦æ”¹]
    D --> F
    E --> F
    
    B -->|é…ç½®| G[ç¯å¢ƒå˜é‡<br/>.envæ–‡ä»¶]
    B -->|é…ç½®| H[æ•°æ®åº“è¿æ¥]
    B -->|é…ç½®| I[åŸŸåå’ŒURL]
    B -->|é…ç½®| J[Nginxé…ç½®]
    B -->|é…ç½®| K[ç¬¬ä¸‰æ–¹æœåŠ¡]
    
    G --> L[âš ï¸ å¿…é¡»æ”¹]
    H --> L
    I --> L
    J --> L
    K --> L
    
    F --> M[ç›´æ¥éƒ¨ç½²]
    L --> N[ä¿®æ”¹åéƒ¨ç½²]
    
    style F fill:#90EE90
    style L fill:#FFB6C1
```

### 3. é…ç½®å˜æ›´è¯¦ç»†æµç¨‹

```mermaid
graph LR
    subgraph æœ¬åœ°ç¯å¢ƒ
        A1[localhost:5001]
        A2[SQLiteæ•°æ®åº“]
        A3[å¼€å‘ç¯å¢ƒ]
        A4[HTTPåè®®]
    end
    
    subgraph é…ç½®å˜æ›´
        B1[ä¿®æ”¹.envæ–‡ä»¶]
        B2[é…ç½®Nginx]
        B3[é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡]
    end
    
    subgraph æœåŠ¡å™¨ç¯å¢ƒ
        C1[essay.gradmotion.com]
        C2[PostgreSQLæ•°æ®åº“]
        C3[ç”Ÿäº§ç¯å¢ƒ]
        C4[HTTPSåè®®]
    end
    
    A1 -->|åŸŸå| B1
    A2 -->|æ•°æ®åº“| B1
    A3 -->|ç¯å¢ƒ| B1
    A4 -->|åè®®| B2
    
    B1 --> C1
    B1 --> C2
    B1 --> C3
    B2 --> C4
    
    style A1 fill:#E6F3FF
    style A2 fill:#E6F3FF
    style A3 fill:#E6F3FF
    style A4 fill:#E6F3FF
    style B1 fill:#FFF4E6
    style B2 fill:#FFF4E6
    style B3 fill:#FFF4E6
    style C1 fill:#E6FFE6
    style C2 fill:#E6FFE6
    style C3 fill:#E6FFE6
    style C4 fill:#E6FFE6
```

---

## ğŸ”„ é…ç½®å˜æ›´å¯¹æ¯”å›¾

### 1. ä»£ç å±‚é¢ï¼ˆä¸éœ€è¦æ”¹ï¼‰

```mermaid
graph LR
    subgraph æœ¬åœ°ä»£ç 
        A1[@app.route<br/>'/api/papers']
        A2[fetch<br/>'/api/papers']
        A3[url_for<br/>'static', ...]
    end
    
    subgraph æœåŠ¡å™¨ä»£ç 
        B1[@app.route<br/>'/api/papers']
        B2[fetch<br/>'/api/papers']
        B3[url_for<br/>'static', ...]
    end
    
    A1 -.->|ç›¸åŒ| B1
    A2 -.->|ç›¸åŒ| B2
    A3 -.->|ç›¸åŒ| B3
    
    style A1 fill:#90EE90
    style A2 fill:#90EE90
    style A3 fill:#90EE90
    style B1 fill:#90EE90
    style B2 fill:#90EE90
    style B3 fill:#90EE90
```

### 2. é…ç½®å±‚é¢ï¼ˆå¿…é¡»æ”¹ï¼‰

```mermaid
graph TD
    subgraph æœ¬åœ°é…ç½®
        A1[FEISHU_REDIRECT_URI<br/>http://localhost:5001/...]
        A2[DATABASE_URL<br/>sqlite:///./papers.db]
        A3[FLASK_ENV<br/>development]
        A4[åŸŸå<br/>localhost:5001]
    end
    
    subgraph é…ç½®å˜æ›´
        B[ä¿®æ”¹.envæ–‡ä»¶<br/>é…ç½®Nginx<br/>é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡]
    end
    
    subgraph æœåŠ¡å™¨é…ç½®
        C1[FEISHU_REDIRECT_URI<br/>https://login.gradmotion.com/...]
        C2[DATABASE_URL<br/>postgresql://...]
        C3[FLASK_ENV<br/>production]
        C4[åŸŸå<br/>essay.gradmotion.com]
    end
    
    A1 --> B
    A2 --> B
    A3 --> B
    A4 --> B
    
    B --> C1
    B --> C2
    B --> C3
    B --> C4
    
    style A1 fill:#FFB6C1
    style A2 fill:#FFB6C1
    style A3 fill:#FFB6C1
    style A4 fill:#FFB6C1
    style B fill:#FFF4E6
    style C1 fill:#90EE90
    style C2 fill:#90EE90
    style C3 fill:#90EE90
    style C4 fill:#90EE90
```

---

## ğŸ“‹ é…ç½®å˜æ›´æ¸…å•ï¼ˆå¯è§†åŒ–ï¼‰

### 1. ç¯å¢ƒå˜é‡å˜æ›´æµç¨‹

```mermaid
graph TD
    A[æ‰“å¼€.envæ–‡ä»¶] --> B{æ£€æŸ¥æ¯ä¸ªé…ç½®é¡¹}
    
    B --> C[FEISHU_REDIRECT_URI]
    B --> D[DATABASE_URL]
    B --> E[FLASK_ENV]
    B --> F[FLASK_DEBUG]
    B --> G[JWT_SECRET_KEY]
    
    C --> C1[localhost:5001]
    C1 --> C2[æ”¹ä¸º<br/>login.gradmotion.com]
    
    D --> D1[sqlite:///./papers.db]
    D1 --> D2[æ”¹ä¸º<br/>postgresql://...]
    
    E --> E1[development]
    E1 --> E2[æ”¹ä¸º<br/>production]
    
    F --> F1[1]
    F1 --> F2[æ”¹ä¸º<br/>0]
    
    G --> G1[ç®€å•å¯†é’¥]
    G1 --> G2[æ”¹ä¸º<br/>å¼ºå¯†é’¥]
    
    C2 --> H[ä¿å­˜æ–‡ä»¶]
    D2 --> H
    E2 --> H
    F2 --> H
    G2 --> H
    
    H --> I[âœ… é…ç½®å®Œæˆ]
    
    style C1 fill:#FFB6C1
    style D1 fill:#FFB6C1
    style E1 fill:#FFB6C1
    style F1 fill:#FFB6C1
    style G1 fill:#FFB6C1
    style C2 fill:#90EE90
    style D2 fill:#90EE90
    style E2 fill:#90EE90
    style F2 fill:#90EE90
    style G2 fill:#90EE90
    style I fill:#90EE90
```

### 2. Nginxé…ç½®æµç¨‹

```mermaid
graph TD
    A[åˆ›å»ºNginxé…ç½®] --> B[é…ç½®åŸŸå]
    B --> C[é…ç½®SSLè¯ä¹¦]
    C --> D[é…ç½®é™æ€æ–‡ä»¶]
    D --> E[é…ç½®ä»£ç†]
    
    B --> B1[server_name<br/>essay.gradmotion.com]
    C --> C1[ssl_certificate<br/>/etc/letsencrypt/...]
    D --> D1[location /static<br/>alias /srv/...]
    E --> E1[proxy_pass<br/>http://127.0.0.1:5001]
    
    B1 --> F[æµ‹è¯•é…ç½®]
    C1 --> F
    D1 --> F
    E1 --> F
    
    F --> G{nginx -t<br/>æµ‹è¯•é€šè¿‡?}
    G -->|æ˜¯| H[é‡å¯Nginx]
    G -->|å¦| I[ä¿®å¤é”™è¯¯]
    I --> F
    
    H --> J[âœ… Nginxé…ç½®å®Œæˆ]
    
    style F fill:#FFF4E6
    style G fill:#FFF4E6
    style J fill:#90EE90
```

### 3. ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®æµç¨‹

```mermaid
graph TD
    A[ç™»å½•é£ä¹¦å¼€æ”¾å¹³å°] --> B[è¿›å…¥åº”ç”¨ç®¡ç†]
    B --> C[æ‰¾åˆ°å®‰å…¨è®¾ç½®]
    C --> D[æ·»åŠ é‡å®šå‘URL]
    
    D --> D1[æœ¬åœ°URL<br/>http://localhost:5001/...]
    D --> D2[æœåŠ¡å™¨URL<br/>https://login.gradmotion.com/...]
    
    D1 --> E[ä¿å­˜é…ç½®]
    D2 --> E
    
    E --> F[åŒæ—¶ä¿®æ”¹.envæ–‡ä»¶]
    F --> G[FEISHU_REDIRECT_URI<br/>æ”¹ä¸ºæœåŠ¡å™¨URL]
    
    G --> H[âœ… ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®å®Œæˆ]
    
    style D1 fill:#E6F3FF
    style D2 fill:#90EE90
    style H fill:#90EE90
```

---

## ğŸ¨ å®Œæ•´éƒ¨ç½²æµç¨‹å›¾

```mermaid
graph TB
    subgraph å‡†å¤‡é˜¶æ®µ
        A1[æœ¬åœ°ä»£ç å¼€å‘å®Œæˆ]
        A2[ä»£ç æäº¤åˆ°GitHub]
    end
    
    subgraph æœåŠ¡å™¨å‡†å¤‡
        B1[SSHç™»å½•æœåŠ¡å™¨]
        B2[å…‹éš†ä»£ç ]
        B3[åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ]
    end
    
    subgraph é…ç½®å˜æ›´
        C1[ä¿®æ”¹.envæ–‡ä»¶]
        C2[é…ç½®Nginx]
        C3[é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡]
    end
    
    subgraph æ•°æ®åº“é…ç½®
        D1[å®‰è£…PostgreSQL]
        D2[åˆ›å»ºæ•°æ®åº“]
        D3[åˆå§‹åŒ–æ•°æ®]
    end
    
    subgraph æœåŠ¡å¯åŠ¨
        E1[å¯åŠ¨Gunicorn]
        E2[å¯åŠ¨Nginx]
        E3[é…ç½®systemd]
    end
    
    subgraph éªŒè¯æµ‹è¯•
        F1[æµ‹è¯•é¦–é¡µ]
        F2[æµ‹è¯•API]
        F3[æµ‹è¯•ç™»å½•]
    end
    
    A1 --> A2
    A2 --> B1
    B1 --> B2
    B2 --> B3
    B3 --> C1
    B3 --> D1
    
    C1 --> C2
    C2 --> C3
    
    D1 --> D2
    D2 --> D3
    
    C3 --> E1
    D3 --> E1
    
    E1 --> E2
    E2 --> E3
    
    E3 --> F1
    F1 --> F2
    F2 --> F3
    
    F3 --> G[âœ… éƒ¨ç½²å®Œæˆ]
    
    style A1 fill:#E6F3FF
    style A2 fill:#E6F3FF
    style C1 fill:#FFF4E6
    style C2 fill:#FFF4E6
    style C3 fill:#FFF4E6
    style D1 fill:#FFF4E6
    style D2 fill:#FFF4E6
    style D3 fill:#FFF4E6
    style E1 fill:#E6FFE6
    style E2 fill:#E6FFE6
    style E3 fill:#E6FFE6
    style F1 fill:#E6FFE6
    style F2 fill:#E6FFE6
    style F3 fill:#E6FFE6
    style G fill:#90EE90
```

---

## ğŸ“Š é…ç½®å˜æ›´å¯¹æ¯”è¡¨ï¼ˆå¯è§†åŒ–ï¼‰

```mermaid
graph LR
    subgraph æœ¬åœ°é…ç½®
        A1[localhost:5001]
        A2[SQLite]
        A3[development]
        A4[HTTP]
    end
    
    subgraph å˜æ›´æ“ä½œ
        B[ä¿®æ”¹é…ç½®]
    end
    
    subgraph æœåŠ¡å™¨é…ç½®
        C1[essay.gradmotion.com]
        C2[PostgreSQL]
        C3[production]
        C4[HTTPS]
    end
    
    A1 -->|åŸŸå| B
    A2 -->|æ•°æ®åº“| B
    A3 -->|ç¯å¢ƒ| B
    A4 -->|åè®®| B
    
    B -->|æ”¹ä¸º| C1
    B -->|æ”¹ä¸º| C2
    B -->|æ”¹ä¸º| C3
    B -->|æ”¹ä¸º| C4
    
    style A1 fill:#FFB6C1
    style A2 fill:#FFB6C1
    style A3 fill:#FFB6C1
    style A4 fill:#FFB6C1
    style B fill:#FFF4E6
    style C1 fill:#90EE90
    style C2 fill:#90EE90
    style C3 fill:#90EE90
    style C4 fill:#90EE90
```

---

## ğŸ¯ å¿«é€Ÿå†³ç­–å›¾

### é‡åˆ°é…ç½®é¡¹ï¼Œå¦‚ä½•åˆ¤æ–­ï¼Ÿ

```mermaid
graph TD
    A[é‡åˆ°ä¸€ä¸ªé…ç½®é¡¹] --> B{è¿™æ˜¯ä»£ç è¿˜æ˜¯é…ç½®?}
    
    B -->|ä»£ç | C[è·¯ç”±å®šä¹‰<br/>@app.route]
    B -->|ä»£ç | D[APIè°ƒç”¨<br/>fetch/]
    B -->|ä»£ç | E[é™æ€æ–‡ä»¶<br/>url_for]
    
    C --> F[âœ… ä¸éœ€è¦æ”¹]
    D --> F
    E --> F
    
    B -->|é…ç½®| G{é…ç½®ç±»å‹}
    
    G -->|ç¯å¢ƒå˜é‡| H[.envæ–‡ä»¶]
    G -->|æ•°æ®åº“| I[DATABASE_URL]
    G -->|åŸŸå| J[server_name]
    G -->|OAuth| K[å›è°ƒURL]
    
    H --> L[âš ï¸ å¿…é¡»æ”¹]
    I --> L
    J --> L
    K --> L
    
    F --> M[ç›´æ¥ä½¿ç”¨]
    L --> N[ä¿®æ”¹åä½¿ç”¨]
    
    style F fill:#90EE90
    style L fill:#FFB6C1
    style M fill:#90EE90
    style N fill:#FFF4E6
```

---

## ğŸ“ é…ç½®å˜æ›´æ£€æŸ¥æ¸…å•ï¼ˆå¯è§†åŒ–ï¼‰

```mermaid
graph TD
    A[å¼€å§‹æ£€æŸ¥] --> B[æ£€æŸ¥.envæ–‡ä»¶]
    B --> C{æ‰€æœ‰é…ç½®å·²ä¿®æ”¹?}
    
    C -->|å¦| D[ä¿®æ”¹é…ç½®]
    D --> B
    C -->|æ˜¯| E[æ£€æŸ¥Nginxé…ç½®]
    
    E --> F{Nginxé…ç½®æ­£ç¡®?}
    F -->|å¦| G[ä¿®å¤Nginxé…ç½®]
    G --> E
    F -->|æ˜¯| H[æ£€æŸ¥ç¬¬ä¸‰æ–¹æœåŠ¡]
    
    H --> I{ç¬¬ä¸‰æ–¹æœåŠ¡å·²é…ç½®?}
    I -->|å¦| J[é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡]
    J --> H
    I -->|æ˜¯| K[æµ‹è¯•åŠŸèƒ½]
    
    K --> L{æ‰€æœ‰åŠŸèƒ½æ­£å¸¸?}
    L -->|å¦| M[ä¿®å¤é—®é¢˜]
    M --> K
    L -->|æ˜¯| N[âœ… éƒ¨ç½²å®Œæˆ]
    
    style C fill:#FFF4E6
    style F fill:#FFF4E6
    style I fill:#FFF4E6
    style L fill:#FFF4E6
    style N fill:#90EE90
```

---

## ğŸ’¡ æ ¸å¿ƒè¦ç‚¹æ€»ç»“

### 1. ä»£ç  vs é…ç½®

```mermaid
graph LR
    subgraph ä»£ç 
        A1[è·¯ç”±å®šä¹‰]
        A2[APIè°ƒç”¨]
        A3[é™æ€æ–‡ä»¶]
    end
    
    subgraph é…ç½®
        B1[ç¯å¢ƒå˜é‡]
        B2[æ•°æ®åº“]
        B3[åŸŸå]
    end
    
    A1 --> C[âœ… ä¸éœ€è¦æ”¹]
    A2 --> C
    A3 --> C
    
    B1 --> D[âš ï¸ å¿…é¡»æ”¹]
    B2 --> D
    B3 --> D
    
    style C fill:#90EE90
    style D fill:#FFB6C1
```

### 2. å¿…é¡»ä¿®æ”¹çš„é…ç½®é¡¹

```mermaid
mindmap
  root((é…ç½®å˜æ›´))
    ç¯å¢ƒå˜é‡
      FEISHU_REDIRECT_URI
      DATABASE_URL
      FLASK_ENV
      FLASK_DEBUG
    Nginxé…ç½®
      server_name
      SSLè¯ä¹¦
      é™æ€æ–‡ä»¶è·¯å¾„
    ç¬¬ä¸‰æ–¹æœåŠ¡
      é£ä¹¦å›è°ƒURL
      å…¶ä»–OAuthæœåŠ¡
```

### 3. ä¸éœ€è¦ä¿®æ”¹çš„ä»£ç 

```mermaid
mindmap
  root((ä»£ç ä¸å˜))
    è·¯ç”±å®šä¹‰
      @app.route
      Blueprintè·¯ç”±
    APIè°ƒç”¨
      fetchç›¸å¯¹è·¯å¾„
      axiosç›¸å¯¹è·¯å¾„
    é™æ€æ–‡ä»¶
      url_forå‡½æ•°
      ../../è·¯å¾„
```

---

## ğŸš€ å¿«é€Ÿå‚è€ƒ

### é…ç½®å˜æ›´é€ŸæŸ¥è¡¨

| ç±»å‹ | é¡¹ç›® | æœ¬åœ° | æœåŠ¡å™¨ | éœ€è¦æ”¹ï¼Ÿ |
|------|------|------|--------|---------|
| **ä»£ç ** | è·¯ç”± | `/api/papers` | `/api/papers` | âŒ ä¸éœ€è¦ |
| **ä»£ç ** | APIè°ƒç”¨ | `fetch('/api/papers')` | `fetch('/api/papers')` | âŒ ä¸éœ€è¦ |
| **é…ç½®** | OAuthå›è°ƒ | `localhost:5001` | `login.gradmotion.com` | âœ… å¿…é¡»æ”¹ |
| **é…ç½®** | æ•°æ®åº“ | `sqlite:///...` | `postgresql://...` | âœ… å¿…é¡»æ”¹ |
| **é…ç½®** | ç¯å¢ƒ | `development` | `production` | âœ… å¿…é¡»æ”¹ |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æœ¬åœ°åˆ°æœåŠ¡å™¨é…ç½®å˜æ›´å®Œæ•´æŒ‡å—](./æœ¬åœ°åˆ°æœåŠ¡å™¨é…ç½®å˜æ›´å®Œæ•´æŒ‡å—_20251219_v1.0.md) - è¯¦ç»†è¯´æ˜æ–‡æ¡£
- [ä»0åˆ°1å®Œæ•´éƒ¨ç½²æ•™ç¨‹](./ä»0åˆ°1å®Œæ•´éƒ¨ç½²æ•™ç¨‹_20251217_v1.0.md) - å®Œæ•´éƒ¨ç½²æµç¨‹
- [ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹](./ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹_20251217_v1.0.md) - ç¯å¢ƒé…ç½®è¯¦ç»†æ­¥éª¤

---

**æœ€åæ›´æ–°**ï¼š2025-12-19  
**ç»´æŠ¤è€…**ï¼šAIå¼€å‘åŠ©æ‰‹  
**ç‰ˆæœ¬**ï¼šv1.0

