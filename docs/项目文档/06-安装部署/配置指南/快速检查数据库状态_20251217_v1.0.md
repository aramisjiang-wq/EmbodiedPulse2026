# å¿«é€Ÿæ£€æŸ¥æ•°æ®åº“çŠ¶æ€

**ç‰ˆæœ¬**: v1.0  
**æ—¥æœŸ**: 2025-12-17

---

## ğŸ” å¿«é€Ÿæ£€æŸ¥æ–¹æ³•

### æ–¹æ³•1ï¼šæ‹‰å–æœ€æ–°ä»£ç åä½¿ç”¨æ£€æŸ¥è„šæœ¬

```bash
cd /srv/EmbodiedPulse2026

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# è¿è¡Œæ£€æŸ¥è„šæœ¬
python3 scripts/check_current_database.py
```

### æ–¹æ³•2ï¼šç›´æ¥ä½¿ç”¨Pythonå‘½ä»¤æ£€æŸ¥ï¼ˆæ— éœ€è„šæœ¬ï¼‰

```bash
cd /srv/EmbodiedPulse2026
source venv/bin/activate

# æ£€æŸ¥å½“å‰æ•°æ®åº“é…ç½®å’Œæ•°æ®é‡
python3 << 'EOF'
import os
from dotenv import load_dotenv

# åŠ è½½.envæ–‡ä»¶
load_dotenv()

print("=" * 60)
print("å½“å‰æ•°æ®åº“é…ç½®æ£€æŸ¥")
print("=" * 60)
print()

# 1. æ£€æŸ¥å…·èº«è®ºæ–‡æ•°æ®åº“
papers_db_url = os.getenv('DATABASE_URL', 'sqlite:///./papers.db')
print("ğŸ“š å…·èº«è®ºæ–‡æ•°æ®åº“:")
print(f"   DATABASE_URL: {papers_db_url}")

if papers_db_url.startswith('postgresql://') or papers_db_url.startswith('postgres://'):
    print("   âœ… ä½¿ç”¨: PostgreSQL")
else:
    print("   âœ… ä½¿ç”¨: SQLite")
    db_file = papers_db_url.replace('sqlite:///', '').replace('sqlite:///', '')
    if os.path.exists(db_file):
        size = os.path.getsize(db_file) / (1024 * 1024)  # MB
        print(f"   æ–‡ä»¶: {db_file}")
        print(f"   å¤§å°: {size:.2f} MB")

print()

# 2. æ£€æŸ¥å…·èº«è§†é¢‘æ•°æ®åº“
bilibili_db_url = os.getenv('BILIBILI_DATABASE_URL', 'sqlite:///./bilibili.db')
print("ğŸ“¹ å…·èº«è§†é¢‘æ•°æ®åº“:")
print(f"   BILIBILI_DATABASE_URL: {bilibili_db_url}")

if bilibili_db_url.startswith('postgresql://') or bilibili_db_url.startswith('postgres://'):
    print("   âœ… ä½¿ç”¨: PostgreSQL")
else:
    print("   âœ… ä½¿ç”¨: SQLite")
    db_file = bilibili_db_url.replace('sqlite:///', '').replace('sqlite:///', '')
    if os.path.exists(db_file):
        size = os.path.getsize(db_file) / (1024 * 1024)  # MB
        print(f"   æ–‡ä»¶: {db_file}")
        print(f"   å¤§å°: {size:.2f} MB")

print()

# 3. æ£€æŸ¥æ•°æ®é‡
print("ğŸ“Š æ•°æ®ç»Ÿè®¡:")
try:
    from models import get_session, Paper
    session = get_session()
    papers_count = session.query(Paper).count()
    session.close()
    print(f"   è®ºæ–‡æ•°é‡: {papers_count} ç¯‡")
except Exception as e:
    print(f"   âš ï¸  æ— æ³•æŸ¥è¯¢è®ºæ–‡æ•°æ®: {e}")

try:
    from bilibili_models import get_bilibili_session, BilibiliUp, BilibiliVideo
    bilibili_session = get_bilibili_session()
    ups_count = bilibili_session.query(BilibiliUp).count()
    videos_count = bilibili_session.query(BilibiliVideo).count()
    bilibili_session.close()
    print(f"   UPä¸»æ•°é‡: {ups_count} ä¸ª")
    print(f"   è§†é¢‘æ•°é‡: {videos_count} ä¸ª")
except Exception as e:
    print(f"   âš ï¸  æ— æ³•æŸ¥è¯¢Bç«™æ•°æ®: {e}")

print()
print("=" * 60)
EOF
```

---

## ğŸ“ æ£€æŸ¥ç»“æœè§£è¯»

### å¦‚æœæ˜¾ç¤ºä½¿ç”¨SQLite

**è¯´æ˜**: è¿˜æ²¡æœ‰åˆ‡æ¢åˆ°PostgreSQL

**ä¸‹ä¸€æ­¥**: 
- å¦‚æœæƒ³åˆ‡æ¢åˆ°PostgreSQLï¼Œæ‰§è¡Œ `bash scripts/switch_to_postgresql.sh`
- æˆ–è€…ä»æœ¬åœ°è¿ç§»ï¼š`bash scripts/migrate_from_local_to_postgresql.sh`

### å¦‚æœæ˜¾ç¤ºä½¿ç”¨PostgreSQLä½†æ•°æ®é‡ä¸º0

**è¯´æ˜**: å·²åˆ‡æ¢åˆ°PostgreSQLï¼Œä½†æ•°æ®è¿˜æ²¡æœ‰è¿ç§»æˆ–æŠ“å–

**ä¸‹ä¸€æ­¥**:
- å¦‚æœæœ¬åœ°æœ‰å®Œæ•´æ•°æ®ï¼Œæ‰§è¡Œè¿ç§»ï¼š`bash scripts/migrate_from_local_to_postgresql.sh`
- å¦‚æœæ²¡æœ‰æœ¬åœ°æ•°æ®ï¼Œç­‰å¾…æˆ–æ‰‹åŠ¨è§¦å‘æ•°æ®æŠ“å–

### å¦‚æœæ˜¾ç¤ºä½¿ç”¨PostgreSQLä¸”æœ‰æ•°æ®

**è¯´æ˜**: âœ… ä¸€åˆ‡æ­£å¸¸ï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-12-17

