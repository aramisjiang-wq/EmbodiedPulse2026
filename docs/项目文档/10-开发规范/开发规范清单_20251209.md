# 开发规范清单

**文档版本**: v1.0  
**创建日期**: 2025-12-09  
**最后更新**: 2025-12-09  
**适用范围**: Robotics ArXiv Daily 项目

---

## 📋 目录

1. [文档管理规范](#文档管理规范)
2. [代码质量规范](#代码质量规范)
3. [用户体验规范](#用户体验规范)
4. [问题处理规范](#问题处理规范)
5. [版本控制规范](#版本控制规范)
6. [性能优化规范](#性能优化规范)
7. [安全性规范](#安全性规范)
8. [测试规范](#测试规范)

---

## 1. 文档管理规范

### 1.1 文档命名规范

**格式**：`文档名称_YYYYMMDD.md`

**规则**：
- ✅ 使用中文命名，简洁明了
- ✅ 日期格式：8位数字（YYYYMMDD）
- ✅ 使用下划线分隔
- ✅ **创建新文档时使用当前日期**
- ✅ **更新文档时，如果内容有重大变更，创建新版本（新日期）**
- ✅ **如果只是小修改，更新文档内的"最后更新时间"**

**示例**：
```
✅ 正确：抓取性能和新论文问题分析_20251209.md
❌ 错误：抓取性能分析.md（缺少日期）
❌ 错误：抓取性能分析_2025-12-09.md（日期格式错误）
```

### 1.2 文档分类规范

**目录结构**：
```
docs/项目文档/
├── README.md                    # 文档索引
├── 文档管理规范.md              # 管理规范
├── 使用说明/                    # 用户使用指南
├── 功能说明/                    # 功能特性说明
├── 技术文档/                    # 技术架构文档
├── 测试文档/                    # 测试结果报告
├── 问题修复/                    # Bug修复记录
├── 优化记录/                    # 优化记录
├── 沟通记录/                    # 开发沟通记录
└── images/                      # 项目图片
```

**分类原则**：
- 📖 **使用说明**：面向用户的操作指南
- 🔧 **功能说明**：功能特性、API接口、配置说明
- 💻 **技术文档**：技术架构、数据库设计、系统设计
- 🧪 **测试文档**：测试结果、测试用例
- 🐛 **问题修复**：Bug修复记录、问题解决方案
- ✨ **优化记录**：UI/UX优化、性能优化
- 📝 **沟通记录**：开发过程中的沟通和决策

### 1.3 文档更新规范

**创建新文档**：
1. 确定文档类型和分类目录
2. 使用标准命名格式（包含当前日期）
3. 放入对应的分类目录
4. 更新 `README.md` 的文档列表

**更新现有文档**：
- **重大变更**：创建新版本（新日期），保留历史
- **小修改**：更新文档内的"最后更新时间"
- **定期维护**：超过3个月的文档可归档

**文档内容规范**：
- 包含文档说明、创建时间、最后更新时间
- 使用Markdown格式
- 结构清晰，使用标题层级
- 包含代码示例时使用代码块

---

## 2. 代码质量规范

### 2.1 底层原则

**核心原则**：
1. ✅ **数据去重是底层原则**
   - 每次获取数据时都要遵循去重机制
   - 数据库层面：主键约束（ID唯一）
   - 应用层面：标题相似度检查（阈值0.85）
   - 所有抓取路径都必须启用去重

2. ✅ **性能优先**
   - 查询速度 < 100ms（90%的请求）
   - 避免不必要的延迟
   - 优化数据库查询（使用索引）

3. ✅ **错误处理**
   - 所有API调用都要有异常处理
   - 提供有意义的错误信息
   - 记录错误日志

### 2.2 代码组织规范

**文件结构**：
```
项目根目录/
├── app.py                    # Flask应用主文件
├── models.py                 # 数据库模型
├── daily_arxiv.py            # 论文抓取逻辑
├── save_paper_to_db.py      # 数据库保存
├── utils.py                  # 工具函数
├── config.yaml               # 配置文件
├── requirements.txt          # 依赖列表
├── templates/                # HTML模板
├── static/                   # 静态资源
│   ├── css/
│   └── js/
└── docs/                     # 文档目录
```

**命名规范**：
- Python文件：`snake_case.py`
- 函数名：`snake_case()`
- 类名：`PascalCase`
- 常量：`UPPER_CASE`
- 变量：`snake_case`

### 2.3 代码注释规范

**函数注释**：
```python
def function_name(param1, param2):
    """
    函数功能描述
    
    Args:
        param1: 参数1说明
        param2: 参数2说明
    
    Returns:
        返回值说明
    
    Raises:
        Exception: 异常说明
    """
    pass
```

**关键逻辑注释**：
- 复杂算法需要注释说明
- 业务逻辑需要注释
- TODO标记需要说明

---

## 3. 用户体验规范

### 3.1 UI/UX设计原则

**设计风格**：
- ✅ **简约有质感**：参考国际大师风格（Apple/Stripe/Linear）
- ✅ **一致性**：统一的字体、颜色、间距
- ✅ **响应式**：支持桌面端、平板、移动端
- ✅ **可访问性**：良好的对比度、可读性

**字体规范**：
- 全局字体：思源宋体（Noto Serif SC）
- 按钮字体：与全局保持一致
- 图表字体：使用相同字体

**颜色规范**：
- 主色调：紫色渐变（#667eea → #764ba2）
- 背景色：白色/浅灰
- 文字色：深灰（#0f172a）
- 避免过多颜色装饰

### 3.2 交互规范

**响应速度**：
- 页面加载：< 2秒
- API响应：< 100ms（90%的请求）
- 用户操作反馈：< 100ms

**交互反馈**：
- 按钮点击：立即反馈（视觉/动画）
- 加载状态：显示加载动画
- 错误提示：清晰明确的错误信息
- 成功提示：操作成功确认

**移动端适配**：
- 布局自适应：桌面端左右布局 → 移动端上下布局
- 字体大小：移动端适当缩小
- 触摸友好：按钮大小 ≥ 44px
- 图表自适应：响应式图表

### 3.3 功能可用性

**核心功能**：
- ✅ 论文浏览和分类展示
- ✅ 搜索和筛选功能
- ✅ 数据统计可视化
- ✅ 手动/自动抓取

**易用性**：
- 操作流程简单直观
- 错误提示清晰
- 帮助文档完善

---

## 4. 问题处理规范

### 4.1 问题发现

**问题来源**：
- 用户反馈
- 系统监控
- 代码审查
- 测试发现

**问题记录**：
- 创建问题分析文档（`问题修复/问题名称_YYYYMMDD.md`）
- 记录问题现象、原因分析、解决方案
- 更新问题状态

### 4.2 问题分析

**分析步骤**：
1. 复现问题
2. 检查日志
3. 分析代码
4. 定位根因
5. 制定方案

**分析文档**：
```markdown
## 问题描述
- 现象
- 影响范围

## 原因分析
- 根本原因
- 相关代码

## 解决方案
- 修复方案
- 代码变更

## 验证结果
- 测试结果
- 修复确认
```

### 4.3 问题修复

**修复流程**：
1. 创建问题分析文档
2. 实施修复
3. 测试验证
4. 更新文档
5. 提交代码

**修复原则**：
- ✅ 修复根本原因，不只是症状
- ✅ 确保不引入新问题
- ✅ 更新相关文档
- ✅ 记录修复过程

---

## 5. 版本控制规范

### 5.1 Git提交规范

**Commit Message格式**：
```
<type>: <subject>

<body>

<footer>
```

**Type类型**：
- `feat`: 新功能
- `fix`: 修复Bug
- `docs`: 文档更新
- `style`: 代码格式（不影响功能）
- `refactor`: 重构
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具相关

**示例**：
```
feat: 完整功能实现 - 数据库集成、Web界面、自动抓取、UI优化

- 添加Flask Web应用和API接口
- 集成SQLite数据库和SQLAlchemy ORM
- 实现论文搜索和筛选功能
- 添加手动和自动抓取功能（APScheduler）
- 优化UI设计（思源宋体、响应式布局）
```

### 5.2 分支管理

**分支策略**：
- `main`: 主分支，稳定版本
- `develop`: 开发分支（可选）
- `feature/*`: 功能分支（可选）

**提交频率**：
- 完成一个功能后立即提交
- 修复问题后立即提交
- 每天结束前提交当日工作

### 5.3 代码审查

**审查要点**：
- 代码逻辑正确性
- 性能影响
- 安全性
- 代码风格一致性
- 文档完整性

---

## 6. 性能优化规范

### 6.1 数据库优化

**索引规范**：
- 查询频繁的字段建立索引
- 组合查询使用复合索引
- 定期检查索引使用情况

**查询优化**：
- 避免N+1查询
- 使用批量操作
- 限制查询结果数量
- 使用分页

### 6.2 API优化

**响应时间**：
- 目标：< 100ms（90%的请求）
- 慢查询：> 500ms需要优化
- 超时设置：合理设置超时时间

**缓存策略**：
- 静态数据：使用缓存
- 频繁查询：缓存结果
- 缓存失效：合理设置TTL

### 6.3 前端优化

**资源优化**：
- CSS/JS压缩
- 图片优化
- 使用CDN（可选）

**加载优化**：
- 懒加载
- 代码分割
- 减少HTTP请求

---

## 7. 安全性规范

### 7.1 数据安全

**敏感信息**：
- ✅ 环境变量存储在`.env`文件
- ✅ `.env`文件加入`.gitignore`
- ✅ 数据库文件不提交到Git
- ✅ API密钥不硬编码

**数据保护**：
- 用户输入验证
- SQL注入防护（使用ORM）
- XSS防护（转义用户输入）

### 7.2 访问控制

**API安全**：
- 限制请求频率
- 验证请求参数
- 错误信息不泄露敏感信息

**部署安全**：
- 使用HTTPS
- 防火墙配置
- 定期更新依赖

---

## 8. 测试规范

### 8.1 测试类型

**功能测试**：
- 核心功能测试
- 边界条件测试
- 异常情况测试

**性能测试**：
- 响应时间测试
- 并发测试
- 负载测试

**兼容性测试**：
- 浏览器兼容性
- 移动端兼容性
- 不同屏幕尺寸

### 8.2 测试文档

**测试记录**：
- 创建测试文档（`测试文档/测试名称_YYYYMMDD.md`）
- 记录测试步骤、结果、问题
- 更新测试状态

---

## 9. 开发流程规范

### 9.1 功能开发流程

1. **需求分析**
   - 理解需求
   - 分析可行性
   - 评估工作量

2. **设计阶段**
   - 技术方案设计
   - UI/UX设计
   - 数据库设计

3. **开发阶段**
   - 编写代码
   - 代码审查
   - 单元测试

4. **测试阶段**
   - 功能测试
   - 性能测试
   - 用户测试

5. **部署阶段**
   - 代码提交
   - 文档更新
   - 部署上线

6. **维护阶段**
   - 监控运行状态
   - 收集用户反馈
   - 持续优化

### 9.2 代码审查清单

**提交前检查**：
- [ ] 代码符合命名规范
- [ ] 代码有适当注释
- [ ] 功能测试通过
- [ ] 没有引入新Bug
- [ ] 性能没有退化
- [ ] 文档已更新
- [ ] Commit message规范

---

## 10. 特殊规范

### 10.1 去重机制（底层原则）

**必须遵循**：
- ✅ 所有数据抓取路径都必须启用去重
- ✅ 数据库层面：主键约束（ID唯一）
- ✅ 应用层面：标题相似度检查
- ✅ 定期检查重复数据（使用`check_duplicates.py`）

**实现位置**：
- `save_paper_to_db.py`: 核心去重逻辑
- `daily_arxiv.py`: 抓取时启用去重
- `utils.py`: 相似度计算函数

### 10.2 性能优化原则

**优化优先级**：
1. 用户体验（响应速度）
2. 资源消耗（API调用、数据库查询）
3. 代码可维护性

**优化策略**：
- 先测量，再优化
- 优化关键路径
- 避免过度优化

### 10.3 文档同步原则

**文档更新时机**：
- 新功能开发 → 更新功能说明文档
- Bug修复 → 更新问题修复文档
- 性能优化 → 更新优化记录文档
- UI改进 → 更新优化记录文档
- 重大变更 → 更新PRD和Spec文档

**文档日期更新**：
- 创建新文档：使用当前日期
- 重大更新：创建新版本（新日期）
- 小修改：更新"最后更新时间"

---

## 11. 检查清单

### 11.1 代码提交前检查

- [ ] 代码符合命名规范
- [ ] 代码有适当注释
- [ ] 功能测试通过
- [ ] 没有引入新Bug
- [ ] 性能没有退化
- [ ] 去重机制已启用
- [ ] 文档已更新（如需要）
- [ ] Commit message规范
- [ ] 敏感信息已排除（.gitignore）

### 11.2 功能上线前检查

- [ ] 功能测试通过
- [ ] 性能测试通过
- [ ] 移动端测试通过
- [ ] 浏览器兼容性测试通过
- [ ] 文档已更新
- [ ] 代码已提交到Git
- [ ] 部署配置已更新

### 11.3 文档更新检查

- [ ] 文档命名符合规范（包含日期）
- [ ] 文档分类正确
- [ ] 文档内容完整
- [ ] 已更新README索引
- [ ] 日期已更新（如需要）

---

## 12. 最佳实践

### 12.1 开发实践

1. **小步快跑**
   - 频繁提交代码
   - 快速迭代
   - 及时反馈

2. **持续优化**
   - 定期审查代码
   - 优化性能瓶颈
   - 改进用户体验

3. **文档先行**
   - 重要功能先写文档
   - 保持文档同步
   - 文档即规范

### 12.2 沟通实践

1. **记录沟通**
   - 重要决策记录到文档
   - 问题讨论记录到沟通记录
   - 变更记录到相应文档

2. **及时反馈**
   - 发现问题及时分析
   - 提供解决方案
   - 更新相关文档

---

## 📊 规范总结

### 核心原则

1. ✅ **数据去重是底层原则** - 所有数据抓取必须遵循
2. ✅ **文档同步更新** - 代码变更，文档同步
3. ✅ **用户体验优先** - 性能、交互、视觉都要考虑
4. ✅ **问题及时处理** - 发现问题，分析原因，提供方案
5. ✅ **代码质量保证** - 规范命名、适当注释、测试验证

### 关键规范

| 类别 | 规范 | 重要性 |
|------|------|--------|
| **文档** | 命名包含日期，分类清晰 | ⭐⭐⭐⭐⭐ |
| **代码** | 去重机制，性能优化 | ⭐⭐⭐⭐⭐ |
| **UI/UX** | 响应式，一致性 | ⭐⭐⭐⭐ |
| **版本控制** | Commit规范，及时提交 | ⭐⭐⭐⭐ |
| **问题处理** | 分析文档，及时修复 | ⭐⭐⭐⭐ |

---

## 📝 规范维护

### 更新原则

- 根据项目发展更新规范
- 记录规范变更历史
- 团队共同遵守

### 规范检查

- 定期审查代码是否符合规范
- 代码审查时检查规范遵循情况
- 持续改进规范

---

**文档创建时间**: 2025-12-09  
**最后更新时间**: 2025-12-09  
**文档维护者**: 开发团队  
**规范版本**: v1.0

