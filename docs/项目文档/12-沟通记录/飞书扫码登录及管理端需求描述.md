## 给Cursor的完整需求描述（优化版）

### 项目概述
开发一个网站认证系统，包含：
1. **用户端**：仅提供飞书扫码登录界面，登录后访问网站内容
2. **管理端**：独立的后台管理系统，用于监控和管理用户

### 系统架构
```
用户浏览器 → 用户前端（扫码登录） → 后端API → 数据库
                                    ↑
管理浏览器 → 管理前端（管理面板） → 后端API
```

### 第一部分：用户端（面向员工）

#### 功能需求：
1. **登录页面**：
   - 飞书扫码登录按钮/二维码
   - 登录后跳转到网站主页面
   - 显示登录用户基本信息

2. **技术要求**：
   - 纯前端页面（可集成到现有网站）
   - 调用后端API进行飞书OAuth2.0认证
   - 本地存储登录状态（JWT token）

#### 页面示例：
```
用户访问网站 → 显示扫码登录页 → 扫码成功 → 进入网站
```

### 第二部分：管理端（独立系统）

#### A. 数据库设计
```sql
-- 核心表：
1. users（用户表）
   id, feishu_id, name, email, department, role, status, last_login, created_at

2. access_logs（访问日志）
   id, user_id, page_url, ip_address, user_agent, access_time, duration

3. admin_users（管理员表，可选）
   id, username, password_hash, role, created_at

-- 注：可使用同一张用户表，通过role字段区分管理员
```

#### B. 后端API需求

```
### 公共API（用户端调用）
POST /api/auth/feishu/login     # 生成飞书登录URL
GET  /api/auth/feishu/callback  # 飞书回调处理
GET  /api/auth/user-info        # 获取当前用户信息
POST /api/auth/logout           # 退出登录

### 管理API（需管理员权限）
GET  /api/admin/users           # 获取所有用户列表
GET  /api/admin/users/:id       # 获取用户详情
PUT  /api/admin/users/:id       # 更新用户状态/角色
GET  /api/admin/logs            # 查看访问日志
GET  /api/admin/stats           # 获取统计数据
POST /api/admin/users/import    # 批量导入用户
```

#### C. 管理前端页面

1. **登录页面**（管理员也使用飞书登录）
2. **仪表盘**：
   - 今日活跃用户数
   - 登录统计图表
   - 系统状态概览

3. **用户管理**：
   - 用户列表（搜索、筛选）
   - 用户详情查看
   - 用户状态管理（启用/禁用）

4. **访问监控**：
   - 实时访问日志
   - 用户行为追踪
   - IP地址分析

### 技术栈建议

```yaml
后端: Node.js + Express / Python + FastAPI
数据库: PostgreSQL / MySQL
前端框架: React / Vue.js
认证: JWT + 飞书OAuth2.0
部署: Docker + Nginx
```

### 开发优先级

#### Phase 1：基础认证系统
1. 飞书OAuth2.0接入
2. 用户表设计
3. 扫码登录流程
4. JWT token生成验证

#### Phase 2：用户端实现
1. 扫码登录页面
2. 用户信息展示
3. 登录状态管理

#### Phase 3：管理端后端
1. 管理员权限中间件
2. 用户管理API
3. 访问日志记录

#### Phase 4：管理端前端
1. 管理登录页面
2. 用户管理界面
3. 数据统计展示

### 飞书配置详细说明

```javascript
// 环境配置
FEISHU_CONFIG = {
  appId: "cli_a6727c4ffc71d00b",
  appSecret: "dt7LyzH6HOexxH4z9ssXpghYgE8PIvSI",
  redirectUri: {
    user: "https://your-site.com/auth/callback",
    admin: "https://admin.your-site.com/auth/callback"
  }
}
```

### 给Cursor的具体提示词示例

**提示词1（基础架构）：**
```
"请帮我设计一个飞书扫码登录系统的数据库Schema，包含：
1. 用户表（存储飞书用户信息）
2. 访问日志表（记录用户访问行为）
3. 考虑到后期扩展需求
请给出PostgreSQL的建表语句和字段说明"
```

**提示词2（后端API）：**
```
"请用Node.js + Express实现飞书OAuth2.0登录接口，需要：
1. /api/auth/feishu/login 生成登录URL
2. /api/auth/feishu/callback 处理回调，获取用户信息
3. 使用JWT生成token
4. 错误处理和日志记录
请提供完整的代码实现"
```

**提示词3（前端组件）：**
```
"请创建一个React组件，实现飞书扫码登录功能：
1. 显示飞书登录二维码
2. 处理登录状态
3. 用户信息展示
4. 响应式设计
请使用antd或类似的UI库"
```

**提示词4（管理面板）：**
```
"请创建一个管理后台的前端页面，包含：
1. 用户列表表格（支持搜索和分页）
2. 用户详情模态框
3. 访问日志时间线
4. 管理员权限验证
请使用Vue3 + Element Plus实现"
```

### 测试要点
1. 飞书扫码登录流程
2. 用户信息正确获取
3. 管理员权限控制
4. 访问日志记录准确性
5. 多用户并发登录

这样的需求描述，Cursor就能明确理解你要构建的是一个**用户认证系统** + **后台管理系统**的组合，并且知道从哪里开始实现了。你需要我先帮你生成哪个部分的代码？

注意：
1.飞书扫码注册后，在用户系统数据库生成的用户记录，给打一个标记，字段是用户身份，标记为：内部
2.管理端的超级管理员登录账号密码 设置为 账号：limx ，密码：limx123456
3.另外，提供飞书配置信息的同事告诉我：