# 检查API实际返回数据结构

**问题**: API返回0，可能是字段名不匹配

---

## 检查实际API返回的数据结构

在服务器上执行：

```bash
cd /srv/EmbodiedPulse2026

# 获取完整的API返回数据（第一个UP主）
curl 'http://localhost:5001/api/bilibili/all?force=1' 2>/dev/null | python3 -m json.tool | python3 << 'PYEOF'
import sys
import json

data = json.load(sys.stdin)
if data.get('success') and data.get('data') and len(data['data']) > 0:
    first_card = data['data'][0]
    print("第一个UP主的完整数据结构:")
    print(json.dumps(first_card, indent=2, ensure_ascii=False))
    
    print("\n" + "="*60)
    print("关键字段检查:")
    print("="*60)
    
    user_info = first_card.get('user_info', {})
    user_stat = first_card.get('user_stat', {})
    
    print(f"\nuser_info:")
    print(f"  name: {user_info.get('name')}")
    print(f"  fans: {user_info.get('fans')}")
    
    print(f"\nuser_stat:")
    print(f"  videos: {user_stat.get('videos')}")
    print(f"  views: {user_stat.get('views')}")
    print(f"  likes: {user_stat.get('likes')}")
    
    print(f"\nuser_stat完整内容:")
    print(json.dumps(user_stat, indent=2, ensure_ascii=False))
else:
    print("❌ API返回数据为空或格式错误")
PYEOF
```

---

## 检查前端期望的字段

前端代码（bilibili.html 第1806, 1825行）：
- `userStat.views` - 总播放数
- `userStat.videos` - 总视频数

API返回（app.py 第1316-1320行）：
- `user_stat.views` ✅
- `user_stat.videos` ✅

字段名是匹配的！

---

## 如果字段匹配但值还是0

可能是：
1. 代码没有真正执行到第1316-1320行
2. 有异常被捕获
3. 缓存中有旧数据

---

**文档结束**

