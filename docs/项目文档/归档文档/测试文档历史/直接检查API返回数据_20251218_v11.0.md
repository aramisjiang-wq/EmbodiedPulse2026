# 直接检查API返回数据

**问题**: 字段名匹配但返回0，需要检查实际API返回的数据结构

---

## 立即执行

在服务器上执行以下命令，检查实际API返回的数据：

```bash
cd /srv/EmbodiedPulse2026

# 方法1：直接curl查看第一个UP主的数据
curl 'http://localhost:5001/api/bilibili/all?force=1' 2>/dev/null | python3 -c "
import sys, json
data = json.load(sys.stdin)
if data.get('success') and data.get('data') and len(data['data']) > 0:
    card = data['data'][0]
    print('第一个UP主:', card.get('user_info', {}).get('name'))
    print('\nuser_stat字段:')
    print(json.dumps(card.get('user_stat', {}), indent=2, ensure_ascii=False))
    print('\n完整user_stat内容:')
    user_stat = card.get('user_stat', {})
    for k, v in user_stat.items():
        print(f'  {k}: {v!r} (type: {type(v).__name__})')
else:
    print('❌ 数据为空')
"

# 方法2：使用检查脚本
venv/bin/python3 scripts/check_api_response_structure.py
```

---

## 如果返回0

检查：
1. 服务器上的代码是否已更新（第1299-1320行）
2. 是否有异常被捕获（查看日志）
3. 数据库中的值是否真的是0

```bash
# 检查代码是否更新
sed -n '1299,1320p' app.py

# 检查是否有异常
sudo journalctl -u embodiedpulse -n 200 --no-pager | grep -E "ERROR|Exception|处理UP主" | tail -20
```

---

**文档结束**

