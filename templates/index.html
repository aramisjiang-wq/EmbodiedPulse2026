<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embodied AI ArXiv Daily - 具身领域前沿论文每日更新</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- 用户认证和登录验证 - 必须在最前面加载，确保强制登录验证生效 -->
    <script src="{{ url_for('static', filename='js/user_menu.js') }}"></script>
    
    <!-- 导航链接修正 - 自动修正导航链接到正确的域名 -->
    <script src="{{ url_for('static', filename='js/nav_links.js') }}"></script>
    
    <!-- 51LA 网站统计 - 延迟加载，避免影响登录验证 -->
    <script>
        // 延迟加载51.la统计脚本，避免CSP错误和影响登录验证
        window.addEventListener('load', function() {
            const script = document.createElement('script');
            script.charset = 'UTF-8';
            script.id = 'LA_COLLECT';
            script.src = '//sdk.51.la/js-sdk-pro.min.js';
            script.onerror = function() {
                console.warn('51.la统计脚本加载失败，已跳过');
            };
            script.onload = function() {
                if (typeof LA !== 'undefined') {
                    try {
                        LA.init({id:"3OKJnG7Jx3IolNJ3",ck:"3OKJnG7Jx3IolNJ3",autoTrack:true,hashMode:true});
                    } catch(e) {
                        console.warn('51.la初始化失败:', e);
                    }
                }
            };
            document.head.appendChild(script);
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- 顶部导航栏 - Tab样式 - 全屏宽度 -->
        <div class="top-nav-fullwidth-wrapper">
            <nav class="top-nav">
                <div class="nav-tabs">
                    <a href="/" class="nav-logo">
                        <img src="{{ url_for('static', filename='images/LimX logo.svg') }}" alt="LimX Logo" class="logo-img">
                    </a>
                    <a href="/" class="nav-tab active">
                        <span>具身论文（Embodied Pulse）</span>
                    </a>
                    <a href="/bilibili" class="nav-tab">
                        <span>具身视频Hub</span>
                    </a>
                    <a href="https://gradmotion.com/" target="_blank" class="nav-tab">
                        <span>具身算法工具箱（GradMotion）</span>
                    </a>
                    <a href="https://paj5uamwttr.feishu.cn/wiki/GaozwfU3iiWA9Nk0LVUcUzKZnHc" target="_blank" class="nav-tab">
                        <span>具身知识库</span>
                    </a>
                    <a href="https://paj5uamwttr.feishu.cn/share/base/form/shrcnYlYb0NorOBVv2P8xRAArDe" target="_blank" class="nav-tab">
                        <span>产品反馈</span>
                    </a>
                    
                    <!-- 个人中心/登录按钮 - 右对齐 -->
                    <a href="/login" class="nav-tab nav-tab-right" id="userLoginBtn">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>登录</span>
                    </a>
                    <a href="/profile" class="nav-tab nav-tab-right" id="userProfileBtn" style="display: none;">
                        <span id="userNameText">加载中...</span>
                    </a>
                </div>
            </nav>
        </div>

        <!-- 主体内容区域 -->
        <div class="main-content-wrapper">
            <div class="main-content">
        <!-- 头部 Banner -->
        <header class="header">
            <div class="header-background"></div>
        </header>

        <!-- 数据仪表盘与趋势模块已下线 -->

        <!-- 研究方向活跃度模块 -->
        <section class="research-activity-section">
            <div class="research-activity-main">
                <div class="research-activity-header">
                    <h2>
                        <i class="fas fa-chart-line"></i> 研究方向活跃度
                    </h2>
                </div>
                
                <!-- 时间范围选择器 -->
                <div class="activity-time-selector">
                    <button class="time-btn" data-weeks="4">最近4周</button>
                    <button class="time-btn active" data-weeks="8">最近8周</button>
                    <button class="time-btn" data-weeks="12">最近12周</button>
                    <button class="time-btn" data-weeks="52">全部</button>
                </div>
                
                <!-- 视图切换标签页 -->
                <div class="activity-view-tabs">
                    <button class="view-tab active" data-view="category">
                        <i class="fas fa-layer-group"></i> 分类视图
                    </button>
                    <button class="view-tab" data-view="tag">
                        <i class="fas fa-tags"></i> 子标签视图
                    </button>
                </div>
                
                <!-- 分类视图 -->
                <div class="activity-view-content" id="categoryView">
                    <div class="activity-chart-container">
                        <canvas id="categoryActivityChart"></canvas>
                    </div>
                    <div class="activity-legend" id="categoryLegend"></div>
                </div>
                
                <!-- 子标签视图 -->
                <div class="activity-view-content hidden" id="tagView">
                    <div class="tag-filter-bar">
                        <select id="tagCategoryFilter" class="tag-filter-select">
                            <option value="">显示全部分类</option>
                            <option value="Perception">感知层</option>
                            <option value="Decision">决策层</option>
                            <option value="Motion Control">运动层</option>
                            <option value="Operation">操作层</option>
                            <option value="Learning">学习与算法</option>
                            <option value="Benchmark">基准</option>
                        </select>
                        <button id="tagShowAllBtn" class="tag-filter-btn">显示全部</button>
                    </div>
                    <div class="activity-chart-container">
                        <canvas id="tagActivityChart"></canvas>
                    </div>
                    <div class="activity-legend" id="tagLegend"></div>
                </div>
            </div>
        </section>

        <!-- 论文清单 -->
        <section class="papers-list-section">
            <div class="papers-list-main">
                    <div class="papers-list-header">
                        <h2>
                            <i class="fas fa-list"></i> 具身论文清单
                        </h2>
                        <button id="refreshPapersBtn" class="btn btn-refresh">
                            <i class="fas fa-sync-alt"></i> 刷新论文数据
                        </button>
                    </div>
                    
                    <!-- 搜索工具栏 -->
                    <div class="search-toolbar">
                        <div class="search-input-wrapper">
                        <i class="fas fa-search"></i>
                            <input type="text" id="searchInput" placeholder="搜索论文标题、作者或摘要...">
                            <button id="clearSearchBtn" class="clear-search-btn hidden" title="清除搜索">
                                <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div id="searchResults" class="search-results hidden"></div>
            
            <!-- 筛选和排序工具栏 -->
                    <div class="filter-sort-bar">
                <div class="filter-group">
                            <i class="fas fa-filter"></i>
                            <label>筛选</label>
                    <select id="venueFilter" class="filter-select">
                        <option value="">所有发表场所</option>
                    </select>
                </div>
                <div class="sort-group">
                            <i class="fas fa-sort"></i>
                            <label>排序</label>
                    <select id="sortBy" class="sort-select">
                        <option value="date">按日期</option>
                        <option value="citations">按被引用数量</option>
                        <option value="title">按标题</option>
                    </select>
                </div>
            </div>

                    <!-- 标签页容器（折叠展开） -->
                    <div class="tabs-container" id="tabs">
                <!-- 标签页将通过JS动态生成 -->
            </div>

            <!-- 最后更新时间 -->
            <div class="last-update-info">
                <i class="fas fa-clock"></i>
                <span>最后更新: <span id="lastUpdateTime">加载中...</span></span>
            </div>

            <!-- 论文列表 -->
            <div class="papers-section-content">
                
                <div class="papers-container" id="papersContainer">
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin fa-3x"></i>
                        <p>加载论文数据中...</p>
                    </div>
                </div>
            </div>
        </section>
            </div> <!-- 结束 main-content -->
            
            <!-- 右侧独立挂窗区域 -->
            <aside class="side-widgets">
                <!-- 论文统计挂件 - 重新设计版 -->
                <div class="paper-stats-widget">
                    <div class="paper-stats-header">
                        <h3><i class="fas fa-chart-line"></i> 论文统计</h3>
                    </div>
                    <div class="paper-stats-content">
                        <!-- 总数 - 大样式，独占一行 -->
                        <div class="stat-item stat-item-total">
                            <div class="stat-label"><i class="fas fa-database"></i> 总数</div>
                            <div class="stat-value stat-value-total" id="totalPapers">-</div>
                        </div>
                        <!-- 其他统计项 - 小样式，3列布局 -->
                        <div class="stats-row">
                            <div class="stat-item stat-item-today">
                            <div class="stat-label"><i class="fas fa-plus-circle"></i> 今日</div>
                                <div class="stat-value stat-value-small" id="todayPapers">-</div>
                        </div>
                            <div class="stat-item stat-item-week">
                            <div class="stat-label"><i class="fas fa-calendar-week"></i> 本周</div>
                                <div class="stat-value stat-value-small" id="weekPapers">-</div>
                        </div>
                            <div class="stat-item stat-item-month">
                            <div class="stat-label"><i class="fas fa-calendar-alt"></i> 本月</div>
                                <div class="stat-value stat-value-small" id="monthPapers">-</div>
                            </div>
                        </div>
                        <div class="stat-update-time">
                            <i class="fas fa-calendar"></i>
                            <span id="statsDate">加载中...</span>
                        </div>
                    </div>
                </div>

                <!-- 活跃作者排行榜挂件 -->
                <div class="author-ranking-widget">
                    <div class="author-ranking-widget-header">
                        <h3><i class="fas fa-trophy"></i> 活跃作者排行榜</h3>
                    </div>
                    
                    <div class="author-ranking-controls">
                        <div class="author-ranking-filters">
                            <select id="authorRankingDays" class="author-ranking-select">
                                <option value="7">近7天</option>
                                <option value="30">近30天</option>
                            </select>
                            <select id="authorRankingCategory" class="author-ranking-select">
                                <option value="">全部领域</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="authorRankingContainer" class="author-ranking-widget-content">
                        <div class="loading-spinner-small">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>加载作者排行榜中...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Bilibili挂件 -->
                <div class="bilibili-widget" style="display: none;">
                    <div class="bilibili-widget-header">
                        <div class="bilibili-header-title">
                            <h3><i class="fab fa-bilibili"></i> B站</h3>
                            <button class="bilibili-toggle-btn" id="bilibiliToggleBtn" title="展开/收起">
                                <i class="fas fa-chevron-down"></i>
                            </button>
                        </div>
                        <div class="bilibili-header-actions">
                            <a href="https://limxdynamics.com/" target="_blank" class="limx-link-btn" title="逐际动力 LimX">
                                <span>逐际动力 LimX</span>
                            </a>
                            <a href="https://space.bilibili.com/1172054289" target="_blank" class="bilibili-link" title="前往Bilibili空间">
                                <i class="fas fa-external-link-alt"></i>
                            </a>
                        </div>
                    </div>
                    <div class="bilibili-widget-content" id="bilibiliContainer">
                        <div class="loading-spinner-small">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>加载Bilibili信息中...</p>
                        </div>
                    </div>
                </div>
                
                <!-- 学生实习机会挂窗 -->
                <div class="jobs-widget collapsed" style="display: none;">
                    <div class="jobs-widget-header" id="jobsWidgetHeader">
                        <h3 class="widget-title-clickable">
                            <i class="fas fa-briefcase"></i> 具身岗位机会
                            <span class="update-badge hidden" id="jobsUpdateBadge" title="有新更新"></span>
                            <i class="fas fa-chevron-down widget-toggle-icon" id="jobsToggleIcon"></i>
                        </h3>
                        <div class="jobs-widget-header-actions">
                            <a href="https://career.limxdynamics.com/index" target="_blank" class="jobs-header-btn" onclick="event.stopPropagation();">
                                <span>LimX招聘🔥</span>
                            </a>
                            <span class="jobs-count" id="jobsCount">-</span>
                        </div>
                    </div>
                    <div class="jobs-widget-content" id="jobsContainer">
                        <div class="loading-spinner-small">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>加载招聘信息中...</p>
                        </div>
                    </div>
                </div>
                
            </aside>
        </div> <!-- 结束 main-content-wrapper -->

        <!-- 抓取状态 -->
        <div id="fetchStatus" class="fetch-status hidden">
            <div class="status-content">
                <div class="status-header">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span id="statusMessage">正在抓取论文...</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 抓取配置模态框已移除 - 现在直接点击按钮执行脚本 -->

    <script src="{{ url_for('static', filename='js/blessing_messages.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
