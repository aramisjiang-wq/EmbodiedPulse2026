# 服务器状态检查命令

## 在服务器上执行以下命令检查状态

### 一键检查脚本

```bash
ssh root@115.190.77.57
cd /opt/EmbodiedPulse
git pull origin main
bash scripts/检查服务器状态.sh
```

### 手动检查步骤

#### 1. 检查项目目录和代码
```bash
ssh root@115.190.77.57
cd /opt/EmbodiedPulse

# 检查目录是否存在
ls -la

# 检查Git状态
git status
git log --oneline -5

# 检查代码是否最新
git fetch origin main
git log --oneline HEAD..origin/main | wc -l
# 如果输出大于0，说明有未同步的代码
```

#### 2. 检查关键文件
```bash
cd /opt/EmbodiedPulse

# 检查关键文件是否存在
ls -la app.py docker-compose.yml Dockerfile requirements.txt
ls -la templates/index.html static/js/app.js

# 如果文件缺失，更新代码
git pull origin main
```

#### 3. 检查Docker服务
```bash
# 检查Docker是否运行
systemctl status docker

# 检查docker-compose
docker-compose --version

# 检查容器状态
cd /opt/EmbodiedPulse
docker-compose ps

# 如果容器未运行，启动服务
docker-compose up -d
```

#### 4. 检查服务访问
```bash
# 测试本地访问
curl -I http://localhost:5001

# 检查端口占用
netstat -tulpn | grep 5001
lsof -i:5001

# 查看容器日志
docker-compose logs --tail=50 web
```

#### 5. 如果服务有问题，修复步骤
```bash
cd /opt/EmbodiedPulse

# 停止所有容器
docker-compose down

# 更新代码
git pull origin main

# 重新构建并启动
docker-compose up -d --build

# 等待启动
sleep 30

# 检查状态
docker-compose ps
docker-compose logs web
```

## 常见问题

### 问题1：代码不完整
**解决**：
```bash
cd /opt/EmbodiedPulse
git fetch origin main
git reset --hard origin/main
git clean -fd
```

### 问题2：容器未运行
**解决**：
```bash
cd /opt/EmbodiedPulse
docker-compose up -d
docker-compose ps
```

### 问题3：服务无法访问
**解决**：
```bash
# 检查容器日志
docker-compose logs web

# 重启服务
docker-compose restart web

# 完全重建
docker-compose down -v
docker-compose up -d --build
```

